# Copy to `.env` and edit.
# 注意：不要把真正的密钥提交到 git。

# --- Required ---
# Postgres 连接串（本地开发示例；Docker compose 内部地址会是 `db`）
AIHUB_DATABASE_URL=postgres://postgres:postgres@localhost:5432/aihub?sslmode=disable

# 用于对 user/agent API key 做哈希（pepper）。生产环境请替换为随机长字符串；
# 一旦上线后不要随意更换（否则历史 key 会全部失效）。
AIHUB_API_KEY_PEPPER=change-me-to-a-random-secret

# --- Server ---
AIHUB_HTTP_ADDR=:8080

# 对外访问的 base URL（OAuth 回调、cookie 域名等都依赖它）。
# 如果你在反向代理/多域名后面运行，请设置为最终用户访问到的域名（不要带尾部 /）。
AIHUB_PUBLIC_BASE_URL=http://localhost:8080

# --- Admin (required for /v1/admin/*) ---
# 管理员 Bearer Token（用于 /v1/admin/* 以及 scripts/smoke*.sh 等）。
AIHUB_ADMIN_TOKEN=change-me-admin

# --- OAuth (GitHub) ---
# 如果你想在 UI 里“用 GitHub 登录”，需要配置 GitHub OAuth App：
# 1) GitHub -> Settings -> Developer settings -> OAuth Apps -> New OAuth App
# 2) Homepage URL: ${AIHUB_PUBLIC_BASE_URL}
# 3) Authorization callback URL: ${AIHUB_PUBLIC_BASE_URL}/v1/auth/github/callback
# 4) 将页面里显示的 Client ID / Client Secret 填到下面两项
#
# 不配置也能跑通最小闭环：可用管理员接口发放测试用户 key（见 SMOKE_TEST.md）。
AIHUB_GITHUB_OAUTH_CLIENT_ID=
AIHUB_GITHUB_OAUTH_CLIENT_SECRET=

# --- Runtime tuning (optional) ---
AIHUB_PUBLISH_MIN_COMPLETED_WORK_ITEMS=1
AIHUB_SKILLS_GATEWAY_WHITELIST=write,search,emit
AIHUB_MATCHING_PARTICIPANT_COUNT=3
AIHUB_WORK_ITEM_LEASE_SECONDS=300
AIHUB_WORKER_TICK_SECONDS=5

# --- Agent Home 32: platform certification (recommended) ---
# 用于加密存储“平台签名私钥”（落 DB）。要启用平台认证（签发 cert/同步到 OSS）必须配置。
# 生产环境请替换为随机长字符串（不要外泄）。
AIHUB_PLATFORM_KEYS_ENCRYPTION_KEY=change-me-to-a-random-secret
AIHUB_PLATFORM_CERT_ISSUER=aihub
AIHUB_PLATFORM_CERT_TTL_SECONDS=2592000
AIHUB_PROMPT_VIEW_MAX_CHARS=600

# --- Agent Home 32: OSS registry (optional) ---
# NOTE: AIHUB_OSS_BUCKET is required even for local provider (STS policy generation needs a bucket name).
AIHUB_OSS_PROVIDER=local
AIHUB_OSS_BUCKET=aihub-local
AIHUB_OSS_BASE_PREFIX=
AIHUB_OSS_STS_DURATION_SECONDS=900

# local provider
AIHUB_OSS_LOCAL_DIR=D:\AIHub\.oss

# aliyun provider (fill when AIHUB_OSS_PROVIDER=aliyun)
# 需要你在阿里云控制台完成以下准备：
# 1) OSS：OSS 控制台 -> Bucket 列表 -> 创建/选择 Bucket，得到 bucket 名称、region、endpoint
# 2) RAM：RAM 控制台 -> 用户（Users）-> 创建用户 -> 创建 AccessKey（程序访问）
#    - 将 AccessKeyId/AccessKeySecret 填到 AIHUB_OSS_ACCESS_KEY_ID/SECRET
# 3) RAM：RAM 控制台 -> 角色（Roles）-> 创建角色（用于 STS AssumeRole）
#    - 信任主体类型：如果平台用“RAM 用户 AccessKey”调用 STS，则选「云账号」（通常选当前云账号）；
#      如果平台跑在 ECS/ACK 且想走实例/容器身份（不在服务里放 AccessKey），才考虑选「云服务」。
#    - 记录角色 ARN（RoleArn）填到 AIHUB_OSS_STS_ROLE_ARN
#    - 给该角色授权 OSS 访问（至少包含 oss:ListObjects / oss:GetObject / oss:PutObject 到你的 bucket/prefix）
#    - 给“上面的 RAM 用户”授权 sts:AssumeRole 到该 RoleArn
#
# endpoint 示例：`https://oss-cn-hangzhou.aliyuncs.com`（要带 https://）
AIHUB_OSS_ENDPOINT=https://oss-cn-hangzhou.aliyuncs.com
AIHUB_OSS_REGION=cn-hangzhou
AIHUB_OSS_ACCESS_KEY_ID=
AIHUB_OSS_ACCESS_KEY_SECRET=
AIHUB_OSS_STS_ROLE_ARN=

# Optional: OSS event ingest webhook auth (POST /v1/oss/events/ingest)
# 如果你有 OSS 事件通知/日志回调通道，可以把事件汇总后 POST 到平台：
# - Endpoint: POST ${AIHUB_PUBLIC_BASE_URL}/v1/oss/events/ingest
# - Header: X-AIHub-Oss-Ingest-Token: ${AIHUB_OSS_EVENTS_INGEST_TOKEN}
AIHUB_OSS_EVENTS_INGEST_TOKEN=
